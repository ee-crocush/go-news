# Сервис маршрутизации go-news

API Gateway для системы микросервисов новостей. Обеспечивает единую точку входа и маршрутизацию запросов к соответствующим микросервисам.

## Назначение

Сервис маршрутизации выполняет роль API Gateway и обеспечивает:
- Единую точку входа для клиентских приложений
- Маршрутизацию HTTP запросов к соответствующим микросервисам
- Централизованную обработку запросов и ответов
- Проксирование запросов между фронтендом и бэкенд сервисами

## Структура проекта

```
├── Dockerfile                      # Docker образ для контейнеризации
├── Makefile                        # Команды для сборки и управления проектом
├── cmd/
│   └── main.go                     # Точка входа в приложение
├── configs/
│   └── config.yaml                 # Конфигурационный файл
├── docs/                           # Автогенерируемая документация Swagger
│   ├── docs.go
│   ├── swagger.json
│   └── swagger.yaml
├── go.mod                          # Go модули
├── go.sum
└── internal/                       # Внутренняя логика приложения
    ├── app/
    │   └── app.go                  # Инициализация и настройка приложения
    └── infrastructure/             # Инфраструктурный слой
        ├── config/
        │   └── config.go           # Работа с конфигурацией
        ├── registry/
        │   └── registry.go         # Регистр сервисов
        └── transport/
            └── httplib/            # HTTP транспортный слой
                ├── dto/            # Data Transfer Objects
                │   ├── comments.go # DTO для комментариев
                │   └── news.go     # DTO для новостей
                ├── handler/        # HTTP обработчики
                │   ├── comments.go # Обработчики комментариев
                │   ├── handler.go  # Базовый обработчик
                │   ├── health/     # Health check endpoints
                │   │   ├── dto.go
                │   │   └── handler.go
                │   ├── news.go     # Обработчики новостей
                │   └── route_names.go # Константы маршрутов
                └── router.go       # Настройка маршрутизации
```

## Локальная разработка

### Требования
- Go 1.21+
- Make

### Запуск приложения
```bash
# Установка зависимостей
go mod download
# Запуск
go run cmd/main.go
```

### Docker
```bash
# Сборка образа
docker build -t api-gateway .

# Запуск контейнера
docker run -p 8080:8080 api-gateway
```

### Генерация документации
```bash
# Генерация Swagger документации
make get-docs
```

После выполнения команды документация будет доступна в папке `docs/` и по эндпоинту `/swagger/` (если настроен Swagger UI).

## Конфигурация

Основная конфигурация находится в файле `configs/config.yaml` и `.env.example`.

## API Endpoints

Сервис проксирует следующие маршруты:

### Новости
- `GET /api/news/` - получение списка новостей
- `GET /api/news/last` - получение последней новости
- `GET /api/news/latest` - получение последних новостей
- `GET /api/news/{id}` - получение детальной информации о новости

### Комментарии
- `POST /api/comments` - создание комментария

### Служебные
- `GET /health` - проверка состояния сервиса
- `GET /ready` - проверка состояния сервисов
- `GET /swagger/` - документация API (если включена)

Подробное описание API контрактов доступно в [contracts.md](../contracts.md).


## Архитектура

Сервис построен по принципам Clean Architecture с разделением на слои:

- **cmd/** - точка входа приложения
- **internal/app/** - слой приложения и бизнес-логики
- **internal/infrastructure/** - инфраструктурный слой
    - **config/** - работа с конфигурацией
    - **registry/** - Регистрация сервисов
    - **transport/httplib/** - HTTP транспорт, роутинг и обработчики

## Roadmap

### Запланированные улучшения:

#### Переход к DDD (Domain Driven Design)
- [ ] Выделение доменного слоя
- [ ] Разделение на bounded contexts
- [ ] Внедрение агрегатов и value objects
- [ ] Создание доменных сервисов

#### Покрытие тестами
- [ ] Unit тесты для всех слоев
- [ ] Integration тесты для HTTP handlers

#### Дополнительные возможности:
- [ ] Middleware для метрик
- [ ] Rate limiting и throttling
- [ ] Аутентификация и авторизация